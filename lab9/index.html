<!DOCTYPE html>
<html>
<head>
  <script type="text/javascript" src="Cart.js"></script>
  <script>
    var xHRObject = false;
    if (window.XMLHttpRequest) {
      xHRObject = new XMLHttpRequest();
    } else if (window.ActiveXObject) {
      xHRObject = new ActiveXObject("Microsoft.XMLHTTP");
    }

    function getData() {
      if (xHRObject.readyState == 4 && xHRObject.status == 200) {
        var serverResponse = xHRObject.responseXML;
        var spantag = document.getElementById("cart");

        if (serverResponse != null) {
          var books = serverResponse.getElementsByTagName("book");
          spantag.innerHTML = "";
          var totalCost = 0;

          for (var i = 0; i < books.length; i++) {
            var book = books[i];
            var title = book.getElementsByTagName("title")[0].textContent;
            var quantity = parseInt(book.getElementsByTagName("quantity")[0].textContent);
            var isbn = book.getElementsByTagName("isbn")[0].textContent;
            var price = parseFloat(book.getElementsByTagName("price")[0].textContent);

            spantag.innerHTML += "<div>" + title + " (ISBN: " + isbn + ") - Quantity: " + quantity + " - Price: $" + (quantity * price) + "</div>";

            totalCost += quantity * price;
          }

          spantag.innerHTML += "<div><b>Total Cost:</b> $" + totalCost + "</div>";
        } else {
          spantag.innerHTML = "";
        }
      }
    }

    function AddRemoveItem(action) {
      var title = document.getElementById("book").innerHTML;
      var isbn = document.getElementById("ISBN").innerHTML;

      var url = "ManageCart.php?action=" + action + "&title=" + encodeURIComponent(title) + "&isbn=" + encodeURIComponent(isbn) + "&value=" + Number(new Date());
      xHRObject.open("GET", url, true);
      xHRObject.onreadystatechange = getData;
      xHRObject.send(null);
    }
  </script>
</head>
<body>
  <br/>
  <img id="cover" src="begaspnet.jpg" />
  <br />
  <br />
  <b>Book:</b><span id="book">Beginning ASP.NET with CSharp</span><br />
  <b>Authors: </b><span id="authors">Hart, Kauffman, Sussman, Ullman</span><br />
  <b>ISBN: </b><span id="ISBN">0764588508</span><br />
  <b>Price: </b><span id="price">$39.99</span>
  <br /><br />
  <a href="#" onclick="AddRemoveItem('Add');">Add to Shopping Cart</a>
  <br /><br />
  <div id="cart"></div>
</body>
</html>
